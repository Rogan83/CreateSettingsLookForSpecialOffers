<?xml version="1.0" encoding="utf-8" ?>

<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="CreateSettingsLookForSpecialOffers.MVVM.Views.Settings"
             xmlns:viewModels="clr-namespace:CreateSettingsLookForSpecialOffers.MVVM.ViewModels"
             Title="Einstellungen">
    
    <VerticalStackLayout BackgroundColor="LightYellow">
        <Grid 
            x:Name="grid"
            RowDefinitions="*,*,*,*,*,*,*"
            ColumnDefinitions ="200,200,200,100"
            >

            <Label Grid.Row="0" Grid.Column="0" Text="Produkt" TextDecorations="Underline" Margin="10" TextColor="Black"/>
            <Label Grid.Row="0" Grid.Column="1" Text="Preisgrenze pro Kg" TextDecorations="Underline" Margin="10" TextColor="Black"/>
            <Label Grid.Row="0" Grid.Column="2" Text="Preisgrenze pro Produkt" TextDecorations="Underline" Margin="10" TextColor="Black"/>
            <Label Grid.Row="0" Grid.Column="3" Text="Löschen" TextDecorations="Underline" HorizontalOptions="Center" Margin="10" TextColor="Black"/>

            <ScrollView x:Name="scrollView" Grid.Row="1" Grid.ColumnSpan="4" HeightRequest="200">
                <ListView x:Name="listView" ItemsSource="{Binding FavoriteProducts}" BackgroundColor="AntiqueWhite">
                    <ListView.ItemTemplate>
                        <DataTemplate>
                            <ViewCell>
                                <Grid ColumnDefinitions ="200,200,200,100">
                                    <Label Grid.Column="0" Text="{Binding Name}" TextColor="Black" Margin="10"/>
                                    <Label Grid.Column="1" Text="{Binding PriceCapPerKg, StringFormat='{0:C}'}" TextColor="Black" Margin="10" />
                                    <Label Grid.Column="2" Text="{Binding PriceCapPerProduct, StringFormat='{0:C}'}" TextColor="Black" Margin="10" />
                                    <ImageButton  
                                        Grid.Column="3"
                                        Margin="10"
                                        Source="delete.png" 
                                        HeightRequest="20" 
                                        HorizontalOptions="Center"
                                        BackgroundColor="AntiqueWhite"
                                        Command="{Binding Source={RelativeSource AncestorType={x:Type viewModels:SettingsModel}},Path=DeleteFavoriteProduct}" 
                                        CommandParameter="{Binding }"
                                        />
                                </Grid>
                            </ViewCell>
                        </DataTemplate>
                    </ListView.ItemTemplate>
                </ListView>
            </ScrollView>

            <Grid   Grid.Row="2" Grid.Column="0" Grid.ColumnSpan="4" 
                    RowDefinitions="*,*,*"
                    ColumnDefinitions="200,200,200,100"
                    BackgroundColor="AntiqueWhite"
                    >
                <Entry Grid.Row="0" Grid.Column="0" WidthRequest="200" x:Name="productName" Placeholder="Produkt Name"  />
                <Entry Grid.Row="0" Grid.Column="1" WidthRequest="200" x:Name="priceCapPerKg" Placeholder="Preisgrenze Pro Kg" Keyboard="Numeric"  />
                <Entry Grid.Row="0" Grid.Column="2" WidthRequest="200" x:Name="priceCapPerProduct" Placeholder="Preisgrenze Pro Produkt" Keyboard="Numeric" />
                <ImageButton 
                        Grid.Row="0" 
                        Grid.Column="3" 
                        Margin="10"
                        Source="add.png"
                        Command="{Binding AddFavoriteProduct}"
                        CommandParameter="{Binding Source={x:Reference grid}}"
                        BackgroundColor="AntiqueWhite"
                        HeightRequest="20"
                        />
            </Grid>

            <Grid
                Grid.Row="3"
                Grid.ColumnSpan="4"
                ColumnDefinitions="2*,2*,*,2*"
                >
                <Label
                    Grid.Column="0"
                    
                    VerticalOptions="Center"
                    Margin="10,10,10,10"
                    Text="E-Mail Adresse:"
                    />
                <Entry
                    Grid.Column="1"
                    VerticalOptions="Center"
                    Margin="10,10,10,10"
                    Placeholder="E-Mail Adresse eingeben"
                    Keyboard="Email"
                    />
                
                <ImageButton 
                    Grid.Column="2"
                    Source="info.png" 
                    BackgroundColor="LightYellow"
                    HeightRequest="20"
                    AutomationProperties.HelpText="Hier stehen die Informationen, die angezeigt werden sollen."
                    Command="{Binding ShowPopupCommand}"
                    CommandParameter="{Binding Source={x:Reference infoLabel}}">

                    <VisualStateManager.VisualStateGroups>
                        <VisualStateGroupList>
                            <VisualStateGroup x:Name="CommonState">
                                <VisualState x:Name="Normal">
                                    <VisualState.Setters>
                                        <Setter Property="Scale" Value="1" />
                                    </VisualState.Setters>
                                </VisualState>
                                <VisualState x:Name="Hovered">
                                    <VisualState.Setters>
                                        <Setter Property="Scale" Value="0.8" />
                                    </VisualState.Setters>
                                </VisualState>
                                <VisualState x:Name="Pressed">
                                    <VisualState.Setters>
                                        <Setter Property="Scale" Value="0.8" />
                                    </VisualState.Setters>
                                </VisualState>
                            </VisualStateGroup>
                        </VisualStateGroupList>
                    </VisualStateManager.VisualStateGroups>
                </ImageButton>

                <Label   
                    Grid.Column="3"
                    Margin="10"
                    x:Name="infoLabel"
                    Text="Damit Sie per E-Mail benachrichtigt werden können, wenn ein oder mehrere Produkte günstig genug sind."
                    LineBreakMode="WordWrap"
                    IsVisible="false"
                    />
            </Grid>








        </Grid>
    </VerticalStackLayout>
</ContentPage>

